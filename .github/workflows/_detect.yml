# SPDX-FileCopyrightText: 2025 RAprogramm
# SPDX-License-Identifier: MIT

name: Detect Changes

on:
  workflow_call:
    outputs:
      rust:
        description: "Whether Rust files changed"
        value: ${{ jobs.changes.outputs.rust }}
      deps:
        description: "Whether dependency files changed"
        value: ${{ jobs.changes.outputs.deps }}
      reuse:
        description: "Whether REUSE-related files changed"
        value: ${{ jobs.changes.outputs.reuse }}

jobs:
  changes:
    name: Detect Changes
    runs-on: ubuntu-latest
    outputs:
      rust: ${{ steps.filter.outputs.rust }}
      deps: ${{ steps.filter.outputs.deps }}
      reuse: ${{ steps.filter.outputs.reuse }}
    steps:
      - uses: actions/checkout@v6
        with:
          fetch-depth: 0
      - uses: dorny/paths-filter@v3
        id: filter
        with:
          base: ${{ github.event.before }}
          filters: |
            rust:
              - 'src/**'
              - 'tests/**'
              - 'Cargo.toml'
              - 'Cargo.lock'
              - '.rustfmt.toml'
            deps:
              - 'Cargo.toml'
              - 'Cargo.lock'
            reuse:
              - 'LICENSES/**'
              - '.reuse/**'
              - '**/*.rs'
              - '**/*.toml'
              - '**/*.yml'
              - '**/*.md'
